#!/usr/bin/env ruby
# filepath: bin/implicitcad_watcher

require_relative "../lib/cad_watcher"

trap("SIGINT") { handle_sigint }

def handle_sigint
  puts "\nCtrl-C received. Exiting."
  exit 130
end

CadWatcher.new(
  bin_path: File.expand_path("~/.cabal/bin/extopenscad"),
  file_globs: ["*.escad"],
  file_regex: /\.escad$/,
  render_cmd_template: ->(bin, src, dest) { "#{bin} -f stl -o \"#{dest}\" \"#{src}\"" },
  debug_mode: false
).start
